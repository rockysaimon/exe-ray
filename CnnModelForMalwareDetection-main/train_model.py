from tensorflow.keras.callbacks import EarlyStopping, ReduceLROnPlateau

def train_model(model, train_generator, validation_generator, epochs, class_dict):
    # Definir el callback de Early Stopping
    early_stopping = EarlyStopping(monitor='val_loss', patience=5, restore_best_weights=True)

    # Entrenar el modelo con Early Stopping
    history = model.fit(
        train_generator,
        epochs=epochs,
        validation_data=validation_generator,
        callbacks=[early_stopping],  # Pasar el callback de Early Stopping
        class_weight=class_dict  # Aqu√≠ se pasa el diccionario de pesos de clase
    )
    return history


